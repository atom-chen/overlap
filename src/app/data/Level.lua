---------------------------
--应用级别的全局工具类
--
--@type app
local Level = class("Level")

Level.LOCALE_LANG_LABEL = {
    Star1             = _("NorScore"),
    Star2             = _("UniScore"),
    Star3             = _("TimeNorScore"),
    Star4             = _("TimeUniScore"),
}

Level.timeFunction =  function(score,t0,x,min)
    local dt = t0 -  math.floor(score/x)
    if dt < min  then
        dt = min end
    return dt
end


Level.data = {}
--场景 ，块数，障碍，星级1，星级2，星级3，初始时间,时间函数参数
Level.data [1] = {1,3,{{0}},{1,0,0},{2,0,0,16},{4,0,0},10,{4,4,1.1}}
Level.data [2] = {1,3,{{0}},{0,1,0},{0,2,0,21}, {0,4,0},10,{4,4,1.1}}
Level.data [3] = {1,3,{{0}},{2,0,21},{2,0,18,1},{2,0,12},0,{0,0,0}}
Level.data [4] = {1,3,{{0}},{0,2,15,3},{0,2,32},{0,2,20},0,{0,0,0}}
Level.data [5] = {1,3,{{1}},{1,0,0},{0,10,0,82},{20,0,0},10,{4,4,1.1}}
Level.data [6] = {1,3,{{2}},{7,0,0},{0,10,0,4},{20,0,0},10,{4,4,1.1}}
Level.data [7] = {1,3,{{4}},{7,0,0},{0,10,0,69},{20,0,0},10,{4,4,1.1}}
Level.data [8] = {1,3,{{3}},{7,0,0},{0,10,0,49},{20,0,0},10,{4,4,1.1}}
Level.data [9] = {1,3,{{3},{4}},{7,0,0},{0,10,0,41},{20,0,0},10,{4,4,1.1}}

Level.data [10] = {2,4,{{5}},{9,0,0},{15,0,0,99},{0,10,0},14,{6,3,1.3}}
Level.data [11] = {2,4,{{1,5}},{8,0,0},{14,0,0,5},{0,8,0},14,{6,3,1.3}}
Level.data [12] = {2,4,{{2,5}},{8,0,0},{14,0,0,2},{0,8,0},14,{6,3,1.3}}
Level.data [13] = {2,4,{{6}},{6,0,35},{6,0,30,81},{6,0,25},0,{0,0,0}}
Level.data [14] = {2,4,{{1,6}},{6,0,35},{6,0,30,90},{6,0,25},0,{0,0,0}}
Level.data [15] = {2,4,{{2,6}},{6,0,40},{6,0,34,27},{6,0,28},0,{0,0,0}}
Level.data [16] = {2,4,{{9}},{8,0,0},{0,9,0,62},{15,0,0},14,{6,3,1.3}}
Level.data [17] = {2,4,{{2,10}},{6,0,0},{0,5,0,34},{10,0,0},14,{6,3,1.3}}
Level.data [18] = {2,4,{{2,9},{2,10}},{6,0,0},{0,5,0,96},{10,0,0},14,{6,3,1.3}}

Level.data [19] = {3,5,{{2}},{7,0,0},{0,8,0,52},{14,0,0},20,{9,2,2.2}}
Level.data [20] = {3,5,{{7}},{6,0,0},{0,7,0,77},{13,0,0},20,{9,2,2.2}}
Level.data [21] = {3,5,{{8}},{6,0,0},{0,7,0,10},{13,0,0},20,{9,2,2.2}}
Level.data [22] = {3,5,{{0}},{6,0,26},{6,0,20,30},{6,0,16},0,{0,0,0}}
Level.data [23] = {3,5,{{6}},{10,0,0},{0,10,0,64},{20,0,0},20,{9,2,2.2}}
Level.data [24] = {3,5,{{3,5}},{0,5,0},{0,10,0,47},{0,15,0},20,{9,2,2.2}}
Level.data [25] = {3,5,{{4}},{15,0,0},{0,15,0,61},{24,0,0},20,{9,2,2.2}}
Level.data [26] = {3,5,{{3}},{7,0,0},{0,8,0,51},{15,0,0},20,{9,2,2.2}}
Level.data [27] = {3,5,{{3},{4}},{7,0,0},{0,7,0,97},{14,0,0},20,{9,2,2.2}}

Level.data [28] = {4,6,{{1}},{9,0,0},{15,0,0,9},{0,10,0},28,{11,1.5,4}}
Level.data [29] = {4,6,{{1,5}},{9,0,0},{15,0,0,26},{0,10,0},28,{11,1.5,4}}
Level.data [30] = {4,6,{{2,5}},{9,0,0},{15,0,0,68},{0,10,0},28,{11,1.5,4}}
Level.data [31] = {4,6,{{2,8}},{9,0,0},{15,0,0,33},{0,10,0},28,{11,1.5,4}}
Level.data [32] = {4,6,{{5,8}},{9,0,0},{15,0,0,91},{0,10,0},28,{11,1.5,4}}
Level.data [33] = {4,6,{{1,6}},{9,0,0},{15,0,0,31},{0,10,0},28,{11,1.5,4}}
Level.data [34] = {4,6,{{2,6}},{9,0,0},{15,0,0,73},{0,10,0},28,{11,1.5,4}}
Level.data [35] = {4,6,{{2,9},{2,10}},{9,0,0},{15,0,0,6},{0,10,0},28,{11,1.5,4}}
Level.data [36] = {4,6,{{3,5},{4,5}},{5,0,0},{10,0,0,74},{0,8,0},28,{11,1.5,4}}

Level.data [37] = {5,7,{{2}},{5,0,0},{7,0,0,29},{9,0,0},45,{15,1,6}}
Level.data [38] = {5,7,{{2,6,10}},{4,0,0},{6,0,0,55},{8,0,0},45,{15,1,6}}
Level.data [39] = {5,7,{{2,5}},{4,0,0},{6,0,0,95},{8,0,0},45,{15,1,6}}
Level.data [40] = {5,7,{{8}},{5,0,0},{7,0,0,38},{9,0,0},45,{15,1,6}}
Level.data [41] = {5,7,{{2,6}},{4,0,0},{6,0,0,71},{8,0,0},45,{15,1,6}}
Level.data [42] = {5,7,{{2,7}},{5,0,0},{7,0,0,88},{9,0,0},45,{15,1,6}}
Level.data [43] = {5,7,{{0}},{4,0,80},{4,0,65,40},{44,0,50},0,{0,0,0}}
Level.data [44] = {5,7,{{0}},{0,4,0},{0,6,0,24},{0,8,0},45,{15,1,6}}
Level.data [45] = {5,7,{{5}},{0,3,80},{0,3,60,36},{0,3,50},0,{0,0,0}}

Level.data [46] = {6,8,{{0}},{7,0,0},{0,9,0,8},{11,0,0},50,{20,0.5,8}}
Level.data [47] = {6,8,{{5}},{5,0,0},{0,3,0,79},{8,0,0},50,{20,0.5,8}}
Level.data [48] = {6,8,{{6}},{6,0,0},{8,0,0,3},{9,0,0},50,{20,0.5,8}}
Level.data [49] = {6,8,{{7}},{3,0,0},{4,0,0,35},{5,0,0},50,{20,0.5,8}}
Level.data [50] = {6,8,{{8}},{3,0,0},{5,0,0,63},{6,0,0},50,{20,0.5,8}}
Level.data [51] = {6,8,{{5,6}},{3,0,0},{4,0,0,46},{5,0,0},50,{20,0.5,8}}
Level.data [52] = {6,8,{{0}},{0,3,0},{0,5,0,76},{0,7,0},50,{20,0.5,8}}
Level.data [53] = {6,8,{{0}},{3,0,80},{3,0,55,94},{3,0,40},0,{0,0,0}}
Level.data [54] = {6,8,{{0}},{0,3,80},{0,3,60,15},{0,3,50},0,{0,0,0}}

Level.data [1011] = {1,3,{{0}},{99999,0,0},{99999,0,0},{99999,0,0},10,{4,4,1.1}}
Level.data [1012] = {1,3,nil,{99999,0,0},{99999,0,0},{99999,0,0},15,{4,4,2}}
Level.data [1021] = {1,4,{{0}},{99999,0,0},{99999,0,0},{99999,0,0},14,{6,3,1.3}}
Level.data [1022] = {1,4,nil,{99999,0,0},{99999,0,0},{99999,0,0},21,{6,3,2.3}}
Level.data [1031] = {1,5,{{0}},{99999,0,0},{99999,0,0},{99999,0,0},20,{9,2,2.2}}
Level.data [1032] = {1,5,nil,{99999,0,0},{99999,0,0,4},{99999,0,0},30,{9,2,3.2}}
Level.data [1041] = {1,6,{{0}},{99999,0,0},{99999,0,0},{99999,0,0},28,{11,1.5,4}}
Level.data [1042] = {1,6,nil,{99999,0,0,4},{99999,0,0},42,{11,1.5,5}}
Level.data [1051] = {1,7,{{0}},{99999,0,0},{99999,0,0},{99999,0,0},40,{15,1,6}}
Level.data [1052] = {1,7,nil,{99999,0,0,4},{99999,0,0},60,{15,1,7}}
Level.data [1061] = {1,8,{{0}},{99999,0,0},{99999,0,0},{99999,0,0},50,{20,0.5,8}}
Level.data [1062] = {1,8,nil,{99999,0,0},{99999,0,0},{99999,0,0},70,{20,0.5,9}}

Level.randSkills = {}
Level.randSkills[1]= {
    {5,{1}},
    {6,{2}},
    {8,{3}},
    {7,{4}},
    {10,{5}},
    {13,{6}},
    {20,{7}},
    {21,{8}},
    {16,{9}},
    {16,{10}},
    {10,{1,5}},
    {13,{1,6}},
    {10,{2,5}},
    {13,{2,6}},
    {20,{2,7}},
    {21,{2,8}},
    {16,{2,9}},
    {16,{2,10}},
    {10,{3,5}},
    {10,{4,5}},
    {13,{5,6}},
    {21,{5,8}},
    {16,{2,6,10}},
    {16,{2,6,9}},
}

Level.randSkills[2]= {
    {5,{1}},
    {6,{2}},
    {8,{3}},
    {7,{4}},
    {10,{5}},
    {13,{6}},
    {20,{7}},
    {21,{8}},
    {16,{9}},
    {16,{10}},
    {10,{1,5}},
    {13,{1,6}},
    {10,{2,5}},
    {13,{2,6}},
    {20,{2,7}},
    {21,{2,8}},
    {16,{2,9}},
    {16,{2,10}},
    {10,{3,5}},
    {10,{4,5}},
    {13,{1,6}},
    {13,{5,6}},
    {21,{5,8}},
    {16,{2,6,10}},
    {16,{2,6,9}},
}

Level.randSkills[3]= {
    {5,{1}},
    {6,{2}},
    {8,{3}},
    {7,{4}},
    {10,{5}},
    {13,{6}},
    {20,{7}},
    {21,{8}},
    {16,{9}},
    {16,{10}},
    {10,{1,5}},
    {13,{1,6}},
    {10,{2,5}},
    {13,{2,6}},
    {20,{2,7}},
    {21,{2,8}},
    {16,{2,9}},
    {16,{2,10}},
    {10,{3,5}},
    {10,{4,5}},
    {13,{1,6}},
    {13,{5,6}},
    {21,{5,8}},
    {16,{2,6,10}},
    {16,{2,6,9}},
}

Level.randSkills[4]= {
    {5,{1}},
    {6,{2}},
    {8,{3}},
    {7,{4}},
    {10,{5}},
    {13,{6}},
    {20,{7}},
    {21,{8}},
    {16,{9}},
    {16,{10}},
    {10,{1,5}},
    {13,{1,6}},
    {10,{2,5}},
    {13,{2,6}},
    {20,{2,7}},
    {21,{2,8}},
    {16,{2,9}},
    {16,{2,10}},
    {10,{3,5}},
    {10,{4,5}},
    {13,{1,6}},
    {13,{5,6}},
    {21,{5,8}},
    {16,{2,6,10}},
    {16,{2,6,9}},
}

Level.randSkills[5]= {
    {5,{1}},
    {6,{2}},
    {8,{3}},
    {7,{4}},
    {10,{5}},
    {13,{6}},
    {20,{7}},
    {21,{8}},
    {16,{9}},
    {16,{10}},
    {10,{1,5}},
    {10,{2,5}},
    {13,{2,6}},
    {20,{2,7}},
    {21,{2,8}},
    {16,{2,9}},
    {16,{2,10}},
    {13,{5,6}},
    {21,{5,8}},
}

Level.randSkills[6]= {
    {6,{2}},
    {10,{5}},
    {13,{6}},
    {20,{7}},
    {21,{8}},
    {16,{9}},
    {16,{10}},
    {10,{2,5}},
    {13,{2,6}},
    {20,{2,7}},
    {21,{2,8}},
    {16,{2,9}},
    {16,{2,10}},
    {13,{5,6}},
    {21,{5,8}},
}


function Level.getStarInfo(level)
    local star1 =Level.data[level][4]
    local star2 =Level.data[level][5]
    local star3 =Level.data[level][6]

    local function getNoTimeStarInfo(star)
        if star[1] and star[1]~=0 then
            return string.format(helper.fromatLO(_("TimeNorScore")),star[3],star[1])
        elseif star[2]  and star[2]~=0  then
            return  string.format(helper.fromatLO(_("TimeUniScore")),star[3],star[2])
        end
    end

    local function getTimeStarInfo(star)
        if star[1] and star[1]~=0 then
            return string.format(helper.fromatLO(_("NorScore")),star[1])
        elseif star[2] and star[2]~=0 then
            return string.format(helper.fromatLO(_("UniScore")),star[2])
        end
    end

    local llbinfos = {}
    if  Level.data[level][7] == 0 then
        --不限时间模式
        table.insert(llbinfos,getNoTimeStarInfo(star1))
        table.insert(llbinfos,getNoTimeStarInfo(star2))
        table.insert(llbinfos,getNoTimeStarInfo(star3))
    else
        table.insert(llbinfos,getTimeStarInfo(star1))
        table.insert(llbinfos,getTimeStarInfo(star2))
        table.insert(llbinfos,getTimeStarInfo(star3))
    end
    return llbinfos
end


return Level